<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ProBoost - Login</title>
  <link rel="stylesheet" href="auth.css">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="logo">
      <img src="Logo.png" alt="ProBoost Logo" class="logo-img">
      <span>ProBoost</span>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main-container">
    <!-- Left Image -->
    <div class="side-image">
      <img src="https://i.pinimg.com/736x/12/e9/af/12e9aff1764df39b155fffd23af8fd7a.jpg" alt="Decorative Left">
    </div>

    <!-- Form Card -->
    <div class="form-card">
      <h2>Login</h2>
      <form id="loginForm" onsubmit="login(event)">
        <input type="email" id="loginEmail" placeholder="Email" required>
        <div class="error-message" id="loginEmailError">Invalid email format</div>

        <div class="password-wrapper">
          <input type="password" id="loginPassword" placeholder="Password" required>
          <span class="toggle-password" onclick="togglePassword('loginPassword', this)">🙈</span>
        </div>
        <div class="error-message" id="loginPasswordError">Invalid password</div>

        <!-- Login button -->
        <button type="submit">Login</button>
      </form>

      <p class="success-message" id="loginSuccess">✅ Login successful</p>
      <p class="switch-text">Don't have an account? <a href="Sign up Page.html">Sign Up</a></p>
    </div>

    <!-- Right Image -->
    <div class="side-image">
      <img src="https://i.pinimg.com/736x/8f/a8/78/8fa878e92dd17ba1c863adfb44f7c6a4.jpg" alt="Decorative Right">
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <p>© 2025 ProBoost. All rights reserved.</p>
  </footer>

  <!-- Scripts -->
  <script>
  // ✅ Initialize users array with admin account
  (function initializeUsers() {
    let users = JSON.parse(localStorage.getItem("users")) || [];
    
    // Add admin account if it doesn't exist
    const adminEmail = "sha123@gmail.com";
    if (!users.some(u => u.email.toLowerCase() === adminEmail.toLowerCase())) {
      users.push({
        id: Date.now(),
        userId: "U001",
        email: adminEmail,
        password: "Admin123!",
        role: "admin",
        createdAt: new Date().toISOString()
      });
      localStorage.setItem("users", JSON.stringify(users));
      console.log("✅ Admin account created: sha123@gmail.com / Admin123!");
    }
  })();

  // Toggle show/hide password
  function togglePassword(id, el) {
    const input = document.getElementById(id);
    if (input.type === "password") {
      input.type = "text";
      el.textContent = "🙉";
    } else {
      input.type = "password";
      el.textContent = "🙈";
    }
  }

  // Show/hide error messages
  function showError(id, message = '', show = true) {
    const el = document.getElementById(id);
    if (message) el.textContent = message;
    el.style.display = show ? 'block' : 'none';
  }

  // Show/hide success message
  function showSuccess(message) {
    const el = document.getElementById('loginSuccess');
    el.textContent = message;
    el.style.display = 'block';
  }

  function hideSuccess() {
    document.getElementById('loginSuccess').style.display = 'none';
  }

  // Clear all messages
  function clearMessages() {
    showError('loginEmailError', '', false);
    showError('loginPasswordError', '', false);
    hideSuccess();
  }

  // ✅ Main login function
  function login(event) {
    event.preventDefault();

    const email = document.getElementById('loginEmail').value.trim();
    const password = document.getElementById('loginPassword').value;

    // Clear previous messages
    clearMessages();

    // Basic validation
    if (!email) {
      showError('loginEmailError', '❌ Email is required');
      return;
    }

    if (!password) {
      showError('loginPasswordError', '❌ Password is required');
      return;
    }

    // Get users from localStorage
    const users = JSON.parse(localStorage.getItem("users")) || [];
    console.log('Available users:', users);

    // Find matching user
    const user = users.find(u => 
      u.email.toLowerCase() === email.toLowerCase() && 
      u.password === password
    );

    if (!user) {
      showError('loginPasswordError', '❌ Invalid email or password!');
      return;
    }

    // Set session data
    sessionStorage.setItem("isLoggedIn", "true");
    sessionStorage.setItem("role", user.role || "user");
    sessionStorage.setItem("userEmail", user.email);
    sessionStorage.setItem("loginTime", new Date().toISOString());

    console.log('✅ Login successful for:', user.email, 'Role:', user.role);

    // Show success and redirect
    if (user.role === "admin") {
      showSuccess("✅ Admin login successful! Redirecting...");
      setTimeout(() => {
        window.location.href = "Admin.html";
      }, 1500);
    } else {
      showSuccess("✅ User login successful! Redirecting...");
      setTimeout(() => {
        window.location.href = "User.html";
      }, 1500);
    }
  }

  // Test credentials display (for development - remove in production)
  console.log('=== TEST CREDENTIALS ===');
  console.log('Admin: sha123@gmail.com / Admin123!');
  console.log('========================');
  </script>
</body>
</html>